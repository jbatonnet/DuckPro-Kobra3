> [!CAUTION]
> **ДАННОЕ ПРОГРАММНОЕ ОБЕСПЕЧЕНИЕ ПРЕДОСТАВЛЯЕТСЯ "КАК ЕСТЬ", БЕЗ КАКИХ-ЛИБО ГАРАНТИЙ. ИСПОЛЬЗУЯ ЕГО, ВЫ ПРИНИМАЕТЕ НА СЕБЯ ВСЕ РИСКИ ЗА СВОИ ДЕЙСТВИЯ**

# Duck Pro CFW

Первая кастомная прошивка, которая действительно необходима для Kobra 3.

:en: [English Readme](./README.md)

## Особенности (упрощённо)

- Веб-интерфейс (Mainsail/Fluidd):
  - Посылайте файлы на печать напрямую из Prusa/Orca Slicer
  - Полный контроль над Kobra 3 с компьютера или телефона
  - Просматривайте и контролируйте карты высот стола
  - Меняйте конфигурацию принтера
  - и т.д.
- Убраны некоторые трюки в printer.cfg, например, связанные с калибровкой Input Shaping
- SSH доступ (логин: `root`, пароль: `rockchip`)
- ADB доступ (порт: `5555`)

## Установка

1. Загрузите последний архив из [Релизов](https://github.com/utkabobr/DuckPro-Kobra3/releases/latest)
2. Распакуйте папку из него на USB-накопитель отформатированный в FAT32 (не переименовывайте и не перемещайте ничего, если ниже не указано иначе)

### 2.3.2.9 или выше
3. Подключите USB-накопитель к принтеру
4. Подождите около 15-20 минут, пока она установится. Anycubic изменили процесс установки, и теперь она автоматически устанавливает файлы swu
5. Прошивка должна перезагрузиться после установки. Если нет, подождите максимально возможное время и перезагрузите её вручную

:warning: Не вынимайте USB-накопитель до завершения. Перезагрузка до завершения установки может повредить файлы!!!

### До версии 2.3.2.9:
3. Переименуйте папку "aGVscF9zb3Nf" в "update"
4. Подключите USB-накопитель к принтеру
5. Настройки => Информация об устройстве => Принтер => Версия прошивки (Не IP-адрес!)
6. Рядом со строкой должна быть оранжевая кнопка, нажмите ее и дождитесь завершения установки

## О нет! У меня ошибка 11407!
Это означает, что Klipper не смог запуститься.

Во-первых, не волнуйтесь, вы всё ещё можете перепрошить стандартную прошивку или попытаться переустановить Duck Pro.

Это может быть связано с неправильным расположением printer.cfg. Это было в версии 01.10.24 (printer_data распаковывался в /useremain/home/ytka/printer_data/printer_data/ вместо /useremain/home/ytka/printer_data/), пожалуйста, обновитесь до 05.10.24 или более поздней версии (или переместите файлы, если знаете, как это сделать), если вы попытались установить его и "закирпичили" принтер.

Ссылка на стандартную прошивку: [2.3.5.3](https://ytkab0bp.ru/Kobra3_2.3.5.3.swu) (Поместить её как update.swu в ту папку со странными символами на 2.3.2.9 и "update" на версиях до 2.3.2.9)

## ЧАВО

**Вопрос**: Как подключиться к веб-интерфейсу?<br>
**Ответ**: Просто откройте IP адрес принтера в браузере с любого устройства, находящегося в той же локальной сети. IP адрес принтера может быть найден в настройках через дисплей принтера.

**В**: Это чистый Klipper? Будет обновляться?<br>
**О**: Нет. Anycubic модифицировали прошивку так сильно (переписали на Golang), что оно не совместимо с чистым Klipper и не будет обновляться.

**В**: Есть планы перейти на чистый Klipper?<br>
**О**: Нет. Это заняло бы слишком много времени. Опытные пользователи Kobra 3 могут форкнуть эту прошивку и переделать всё на чистый Klipper.

**В**: Как установить аддоны для Klipper?<br>
**О**: Простых способов сделать это не существует.

**В**: Как поблагодарить автора?<br>
**О**: [Boosty](https://boosty.to/ytkab0bp)

## Особенности

- [Python 3.11](https://python.org)
- [Moonraker](https://github.com/Arksine/moonraker) - Изменён для Kobra 3 (https://github.com/utkabobr/moonraker/tree/duckpro), сделана эмуляция карты стола для goklipper, сделана эмуляция необходимых фич которые goklipper не поддерживает
- [Nginx](https://nginx.org)
- [Mainsail](https://github.com/mainsail-crew/mainsail)
- [fbgrab](https://github.com/GunnarMonell/fbgrab)
- [socat](http://www.dest-unreach.org/socat)
- Восстановлен ADB
- Восстановлен [OpenSSH](https://www.openssh.com) - (`root`:`rockchip`)
- Мелодия At Doom's Gate при установке (Портировано [отсюда](https://github.com/robsoncouto/arduino-songs/blob/master/doom/doom.ino))
- На основе 2.3.2.9

Используйте `/useremain/dist/bin/` для большинства бинарников

## Сборка

Используйте `./create_update.sh`
